# 챗봇 시스템 동작 원리 (상세 설명)

이 문서는 지식산업센터 전문 챗봇이 어떻게 작동하는지, 특히 **RAG (검색 증강 생성)** 기술이 어떻게 적용되었는지 자세히 설명합니다.

## 1. 전체 흐름도 (상세)

```mermaid
graph TD
    User[👤 사용자] -->|1. 질문: '입주 조건이 뭐야?'| UI[💻 웹사이트 (채팅창)]
    UI -->|2. API 요청| Server[🖥️ 서버 (Next.js)]
    
    subgraph "RAG (검색 증강 생성) 프로세스"
        Server -->|3. 관련 내용 검색| KB[📂 지식 베이스 파일들\n(data/*.md)]
        KB -->|4. 데이터 추출: '제조업, 지식산업...'| Server
        
        Server -->|5. 프롬프트 조합| Prompt[📝 완성된 명령문\n(질문 + 지식 + 규칙)]
        
        Prompt -->|6. 전송| AI[🧠 Google Gemini AI]
    end
    
    AI -->|7. 답변 생성| Stream[🌊 실시간 답변 스트림]
    Stream -->|8. 한 글자씩 전송| UI
    UI -->|9. 화면 표시| User

    style User fill:#f9f,stroke:#333,stroke-width:2px
    style UI fill:#bbf,stroke:#333,stroke-width:2px
    style Server fill:#dfd,stroke:#333,stroke-width:2px
    style AI fill:#fdd,stroke:#333,stroke-width:4px
    style KB fill:#ffd,stroke:#333,stroke-width:2px
    style Prompt fill:#fff,stroke:#333,stroke-dasharray: 5 5
```

## 2. 핵심 기술: RAG (Retrieval-Augmented Generation)

이 챗봇은 단순히 AI에게 물어보는 것이 아니라, **오픈북 시험**을 보는 것과 같습니다.

*   **일반 챗봇**: AI가 학습한 기억에만 의존해서 답변합니다. (가끔 틀린 정보를 말할 수 있음)
*   **이 챗봇 (RAG)**: 질문을 받으면 먼저 **교과서(지식 베이스)**를 펼쳐서 관련 내용을 찾습니다. 그리고 그 내용을 보고 답변합니다.

### 작동 예시

1.  **사용자 질문**: "취득세 감면 얼마나 돼?"
2.  **시스템의 속마음 (내부 처리)**:
    *   *"잠깐, '취득세'랑 관련된 내용을 지식 베이스에서 찾아보자."*
    *   *(문서 검색 중...)* -> *"찾았다! '취득세 35% 감면'이라는 내용이 있네."*
    *   *"이제 AI한테 이렇게 시켜야지: '사용자가 취득세를 물어봤어. 참고 자료에 따르면 35% 감면이래. 이걸 바탕으로 친절하게 대답해줘.'"*
3.  **AI의 답변**: "네, 2025년 기준으로 취득세는 35% 감면 혜택이 있습니다."

## 3. 주요 구성 요소

| 요소 | 역할 | 비유 |
| :--- | :--- | :--- |
| **웹사이트 (Frontend)** | 사용자와 대화하는 창구 | 은행 창구 직원 |
| **서버 (Backend)** | 질문을 받아 처리하고 AI와 통신하는 관리자 | 은행 지점장 |
| **지식 베이스 (Data)** | `data/` 폴더 내의 모든 마크다운 파일 (법률, 세금 정보 등) | 업무 매뉴얼 / 법전 |
| **Google Gemini (AI)** | 문맥을 이해하고 자연스러운 말을 만드는 두뇌 | 똑똑한 컨설턴트 |

## 4. 왜 이 방식이 좋은가요?

1.  **거짓말 방지 (Hallucination 억제)**: AI가 모르는 내용을 지어내지 않고, 제공된 문서에 근거해서만 답합니다.
2.  **업데이트 용이**: 법이 바뀌면 AI를 다시 학습시킬 필요 없이, **지식 베이스 파일(문서)**만 고치면 바로 반영됩니다.
3.  **보안**: 회사의 중요한 문서를 AI에게 영구적으로 학습시키지 않고, 필요할 때만 잠깐 보여주는 방식이라 더 안전합니다.
